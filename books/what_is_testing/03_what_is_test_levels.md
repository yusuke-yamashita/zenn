---
title: "テストレベルってなんなの？" # 記事のタイトル
---

# はじめに
本記事は以下の記事からインスパイアされ作成されています。
https://nihonbuson.hatenadiary.jp/entry/2019/12/03/003000

また、ソフトウェアテストAdvent Calendar 2024の参加記事でもあります。
https://qiita.com/advent-calendar/2024/softwaretesting

こちらに記載する記事は筆者が考える「オレオレ定義」であり、「正しい定義」を知りたい場合は各規約を参照してください。  

それでもzennで書く意味は、読者の方がこの記事を読むことによって「テストレベル」に対する理解や思考が深まることを期待するからです。  
この記事を元に、「自分はどうだろう」と考えたり、議論していただければ嬉しいです。  

# テストレベルとは

## テストレベルの定義

「テストレベル」の定義はISTQBでは以下となっています。  


> テストレベル（test level）
> 具体的にインスタンス化したテストプロセス。
> 同義語
> テストステージ（test stage）

https://glossary.istqb.org/ja_JP/term/test*level*2*1

2018年にテストレベルを学んだ筆者としては、上記の定義は一昔前と異なっているように思えました。
そして、なかなか直感的に理解できる内容ではないのかなと思います。

そこで、私が使うテストレベルの定義を以下で示します。  

**「テスト対象を何らかの関心ごとでまとめて管理・実行されるテスト活動の集まり」**

私はテストプロセスがインスタンス化されることよりも、「テスト対象がなにか」というところに重点を置きたいと考えています。

### おまけ：ISTQBの定義の解説

本記事の主要な目的ではないですが、せっかくなのでISTQBの定義についても軽く解説しておこうと思います。
あくまでやましたの理解です。

「インスタンス化した」とは難しい表現ですが、「実際に利用するもの」くらいに捉えるといいです。
そう捉えると、"実際に利用するテストプロセス"と読み替えることが可能です。

ここでいう「テストプロセス」とは、テスト活動におけるプロセスです。
ISTQBでは、標準のテストプロセスとして、テスト計画〜テスト完了作業の一連の流れを定義しており、それらがテストプロセスです。

それらはあくまで「標準のテストプロセス」であり、「テストプロセスモデル」というクラスと言い換えることができると思います。

それを実際に利用する際に、特定のテストレベルのテストプロセスとして、テスト計画〜テスト完了作業を行なう（一部省略することもある）がこの用語における「インスタンス化」だと捉えています。

なので、特定のソフトウェア開発のなかで単体テストレベルのテストプロセスが存在します。
そして同時にシステムテストプロセスが存在するという世界観になります。

「具体的にインスタンス化する」というのはすごく29119みを感じました。

## テストレベルの識別

テストレベルの定義をする前に、私がテストプロセスを聞き取りする時に用いる図を紹介します。

![](/images/test_level_model.png)

典型的なテストレベルの名前として、「単体テスト」「システムテスト」が用いられます。
テストレベルの名前は会社によって独自の名前をつけられることが多々あります。
先入観を与えないため、上記の図では敢えて名前を書かないようにしています。  

私は個別のテストレベルについて「これ」という定義はしません。
なので、新しい開発プロジェクトに出会うたび、「テストレベルの識別」という活動が必要になります。

ここからは私がテストレベルを識別する際に考える観点をいくつか紹介します。  

* テスト対象の結合度
* 開発環境の種類（代表性、忠実性）
* テストベースの詳細度
* 品質ゲート
* 提供側と受け入れ側

これらは「こう分けるといいよ」ではない点に注意してください。
これらは私の経験則から「こんなのを元に識別してる現場があるよ〜」くらいに思ってほしいです。

# テストレベルを識別する観点

## テスト対象の結合度

もっとも一般的かつ、効果的だと考えるのが「テスト対象の結合度」です。
ソフトウェアは一般的に、システム=>サブシステム=>プログラム=>モジュールという形で、構造的に詳細化されます。
(上記の用語はコンピュータシステムの基礎第18版参照しました。)

組織によってはプログラムが「サービス」がだったり、モジュールが「クラス」や「メソッド」、「コンポーネント」という名前だったりします。

テスト対象の結合度の観点で識別した場合、テストレベルは以下のようになります。
* モジュール単位でテストを行なう、たとえば**ユニットテスト**
* サブシステムまで結合した状態でプログラム間のやりとりをテストする、たとえば**コンポーネント統合テスト**
* システムまで結合した状態で行なう、たとえば**システムテスト**
* システムが依存する外部サービスまで使った状態で行なう、たとえば**システム統合テスト**

結合度を分けることには意味があります。
それぞれの結合度で実施することで、たとえば以下の効果を期待します。
* テストのスコープを狭める
* テスト実行のスピードを調整する
* デバッグをしやすくする
* それぞれの結合度での信頼の積み上げ
* 他チームに渡すための自信をつける

これはシーケンシャルでもアジャイルでも成り立つテストレベルの識別方法です
。
「テスト対象の結合度」と名つけていますが、ソフトウェアエンジニアリングにおける正式な名前を私はよくわかっていません。

## テスト環境の種類、忠実性

「テスト環境の種類」という観点でも識別できます。
「テスト環境の忠実性」ともいいます。古い書籍では「テスト環境の代表性」と表現することもあります。

端的に言えば、「テスト環境がどれだけ本番環境に近いか」ということを表しています。
開発者のローカル環境が最も本番環境から遠く、本番環境と同等の動作環境であれば、本番環境に近い、つまり「テスト環境の忠実性が高い」という意味になります。

テスト環境の種類、忠実性によってテストレベルを識別することで、以下の効果を期待します。
* テスト環境を必要最低限にして、テスト環境を用意する費用を抑える
* テスト環境に依存するテストを識別して計画する
* 特定のテスト環境依存のバグを検出する

テスト環境の種類を識別するのは、主にハードが関わる組み込み系で利点があります。
たとえば、組み込みだとハードの用意に時間とコストがかかるので、「ハードが必要なテストはハードのある環境で集中してやる」のような考えは一定のコストメリットがあると考えます。

また、Web系であってもインフラの設定の有無により確認するテストを識別する場合もあります。
一方で、最近のIaCの世界観では結合度と同じ意味で使われている傾向があります。

## テストベースの詳細度

「テストベースの詳細度」は主にシーケンシャルな開発を想定しています。
いわゆるW字モデルを想定するといいかもしれません。

それぞれのテストベースに記載された内容が、「実際に実装しているか」「そのなかでバグがあるか」を確認します。
これらはそれぞれテストレベルとして識別されます。

このテストレベルが成り立つ根拠として、それぞれの成果物を段階的詳細化する場合があります。
「要件定義ベースのテストは要件定義ベースのテストで見たらいいし、単体テストは単体テストの設計書に書いてある内容をテストすればいいよね」という世界観です。

一方、このテストレベルの識別には注意が必要です。
成熟度が高いプロジェクトでない場合、テストベースとテストレベルが1対1で対応できることは少ないです。

「1つのテストレベルでテスト条件は要件定義書から拾って期待結果は基本設計書から拾います」という現場は多くあります。
そのため、記事の冒頭で示したテストレベルの図では、さまざまなテストベースがさまざまなテストレベルに飛ぶカオスな図となっています。

テストベースの詳細度によってテストレベルを識別することによって、以下の効果を期待します。
* テストベースに対するトレーサビリティを確保する
* 「何がテストベースか」という観点でスコープを狭める
* 設計書に対する検証を実施する（ベンダー委託の場合によくある）

## 品質ゲート

「品質ゲート」の場合もシーケンシャルな開発を想定しています。
品質ゲートとは、「下位のテストレベルが完了基準を満たし、品質への信頼性が高まっていることを確認してから次のテストレベルに移行する」という運用です。

「品質保証部」とかのIV＆V的な観点がある場合も私はこの識別を行ないます。

以下の効果を期待しています。
* IV＆Vができる
* 下位のテストが完了することで、そのテストレベルのスコープに集中することができる

## 提供側と受け入れ側

受け入れテストの存在意義を考えるために設定しています。
これは特に、受発注関係がある現場であります。

以下の効果を期待しています。
* 提供側がきちんと仕事をしているかを評価するタイミングを作る
* 契約通りに作られているかどうかを検査する

# テストレベルを識別するモチベーション

「テストレベル」という言葉があり、基本情報やJSTQB FLレベルでも普通に使われていることを私は知っています。
しかしながら、人によってそれらの理解はバラバラというのが現状です。

その結果、不毛なテストの責務の押し付け合いや、「僕お勉強したから知ってるもん」と意固地になる人を、私は何度も見ています。
私は「その人々と同じ土俵で戦いたくない」と思っています。

なので、「テストレベル」という概念を取り入れつつ、具体的な個別のテストレベルについては柔軟に定義していこうというアイデアを持ったのでした。

「これらの背景があるにもかかわらず、なんでテストレベルを使わないといけないの」という意見もあります。
それについては、私は以下の効果を期待しているからです。

* テストスコープを定義することで無限のテストを防ぐ
* より早い段階で、より早いテストを実現することができる
* 専門家が実施するスコープとして明確になる

# その他のテストレベルらしき分け方に対する私の考え

これらの他にもさまざまなテストレベルらしき分け方があります。
それらについては私は「テストレベル」とはちょっと違うんじゃないかという見解を持っています。

**この分け方が変という話ではなく、別軸で分けて考えてもいい**という意味です。

## テストダブルを使うかどうか

結合度や環境に近いところがありますが、テストダブルやモックを使うかどうかでもテストレベルの判定を行なうことがあります。  
とくにコードベースのテストではありがちで、いわゆるQAエンジニアが行なうテストではなく、開発者が行なうテストのレベルを判別するために使います。  

品質保証の観点から言えば、ソフトウェアやテスト環境の忠実性と意味は変わらないと考えています。
一方で、テストコードを実装する際の技術的側面や、モックフレームワークを議論する際によく使われます。

しかしながら、テストマネジメントの観点からは、まず上記にて挙げたような識別方法でテストレベルを割り当てたいです。
その後、そのテストレベル内で許容できるテストダブルを検討することがいいのではないかと考えています。

## テストサイズ

Googleで定義され、「テストレベルはもう古い、これからはテストサイズ」って言っている人もよく見ます。
これらは使用されるリソースや実行時間に着目して、テストを分けるような考え方です。

この考え自体はいいと思います。
一方で、テストサイズは自動テストのマネジメントを行なう際に使う基準であるので、テストレベルを判定する唯一の基準として使うのは使いづらいかなと思っています。

# おわりに

「テストレベル」とは基本情報でも出てくる概念です。
そして、なんとなく共通認識を持ってると勘違いして、「これ単体テストだよね」「システムテストだよね」って言ってる人は多いと思います。  

しかし、それらのテストレベルが識別された背景を理解しているかというと、人によってバラバラだったりします。  

アドベントカレンダーなので、これらの分け方について体系的に示している書籍を紹介したかったのですが、とくにない気がします。
すみません。   
ですのでこの記事をきっかけに、テストレベルの背景について思いを馳せていただければ幸いです。  